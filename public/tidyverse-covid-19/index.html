<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta name="HandheldFriendly" content="True" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<meta name="generator" content="Hugo 0.69.2" />

<link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/amzrk2/poal-jsdelivr/amzrk2/favicons/favicon.ico" />


<title>Introduction to the Tidyverse - data&#43;science</title>

<meta name="author" content="Morgan Essex" />
<meta name="description" content="Import Munge Plot   We’re going to be using data from the COVID Tracking Project in the US. The API is easily accessible, and a woman already created a wrapper package for R to make accessing historical and current statistics incredibly simple.
 Import Calling library(tidyverse) will load all the functions we’ll need today, except we must also import magrittr, which provides us with the pipe (%&gt;%) operator for chaining syntax." />

<meta name="keywords" content="tidyverse" />


<meta property="og:title" content="Introduction to the Tidyverse" />
<meta property="og:description" content="Import Munge Plot   We’re going to be using data from the COVID Tracking Project in the US. The API is easily accessible, and a woman already created a wrapper package for R to make accessing historical and current statistics incredibly simple.
 Import Calling library(tidyverse) will load all the functions we’ll need today, except we must also import magrittr, which provides us with the pipe (%&gt;%) operator for chaining syntax." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/tidyverse-covid-19/" />
<meta property="article:published_time" content="2020-04-27T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-04-27T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Introduction to the Tidyverse"/>
<meta name="twitter:description" content="Import Munge Plot   We’re going to be using data from the COVID Tracking Project in the US. The API is easily accessible, and a woman already created a wrapper package for R to make accessing historical and current statistics incredibly simple.
 Import Calling library(tidyverse) will load all the functions we’ll need today, except we must also import magrittr, which provides us with the pipe (%&gt;%) operator for chaining syntax."/>






<link rel="stylesheet" href="/css/main.min.css" />



<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.0/dist/jquery.min.js" integrity="sha256-xNzN2a4ltkB44Mc/Jz3pT4iU1cmeR0FkXs4pru/JxaQ=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.0/lazysizes.min.js" integrity="sha256-h2tMEmhemR2IN4wbbdNjj9LaDIjzwk2hralQwfJmBOE=" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css" integrity="sha256-h20CPZ0QyXlBuAw7A+KluUYx/3pK+c7lYEpqLTlxjYQ=" crossorigin="anonymous" />









<body class="d-flex flex-column h-100">
    <header>
    
    <div class="container-lg clearfix">
        <div class="col-12 p-3">
            <a id="main-title" href="/">data&#43;science</a>
            <span id="sub-title"></span>
        </div>
    </div>
</header>

    <main>
        <div class="container-lg clearfix">
            
            <div class="col-md-9 col-12 float-left" id="content">
                
<article>
    <h4 id="post-title">
        <a href="/tidyverse-covid-19/">Introduction to the Tidyverse</a>
    </h4>
    <div id="post-meta">
        <span>
    <time datetime="2020-04-27 00:00:00 &#43;0000 UTC">2020-04-27</time> |
</span>
<span>
    <span>757 words</span> |
</span>
<span>
    
    
    <a href="//tags/tidyverse/">tidyverse</a>
    
    
</span>
    </div>
    
    <div class="markdown-body" id="post-content">
        

<div id="TOC">
<ul>
<li><a href="#import">Import</a></li>
<li><a href="#munge">Munge</a></li>
<li><a href="#plot">Plot</a></li>
</ul>
</div>

<p>We’re going to be using data from the COVID Tracking Project in the US. The API is easily accessible, and a woman already created a wrapper package for R to make accessing historical and current statistics incredibly simple.</p>
<div class="figure">
<img src="../data/covid-tidyverse/covidtracking.png" />

</div>
<div id="import" class="section level3">
<h3>Import</h3>
<p>Calling <code>library(tidyverse)</code> will load all the functions we’ll need today, except we must also import <code>magrittr</code>, which provides us with the pipe (<code>%&gt;%</code>) operator for chaining syntax.</p>
<pre class="r"><code>library(tidyverse)  # data science toolkit
library(magrittr)   # corresponding operators
library(covid19us)  # scrapes https://covidtracking.com/ API
library(ggsci)      # custom color palettes
library(ggpubr)     # publication-ready plots</code></pre>
<p><br><br> Then, let’s load the complete longitudinal dataset and select the variables that will be relevant for our analysis.</p>
<pre class="r"><code>states.data &lt;- get_states_daily() %&gt;%
    select(c(&#39;state&#39;,&#39;date&#39;,&#39;positive&#39;,&#39;negative&#39;,&#39;death&#39;,&#39;total_test_results&#39;))

states.data</code></pre>
<pre><code>## # A tibble: 2,929 x 6
##    state date       positive negative death total_test_results
##    &lt;chr&gt; &lt;date&gt;        &lt;int&gt;    &lt;int&gt; &lt;int&gt;              &lt;int&gt;
##  1 AK    2020-04-26      341    15836     9              16177
##  2 AL    2020-04-26     6270    67281   216              73551
##  3 AR    2020-04-26     2941    36528    49              39469
##  4 AS    2020-04-26        0        3     0                  3
##  5 AZ    2020-04-26     6526    58285   275              64811
##  6 CA    2020-04-26    42164   483920  1710             526084
##  7 CO    2020-04-26    12968    46823   672              59791
##  8 CT    2020-04-26    25269    54542  1924              79811
##  9 DC    2020-04-26     3841    14227   178              18068
## 10 DE    2020-04-26     4034    15215   120              19249
## # … with 2,919 more rows</code></pre>
<p>Additionally, we’re going to pull a csv file from <a href="https://worldpopulationreview.com/" class="uri">https://worldpopulationreview.com/</a> that contains state-abbreviation pairs (e.g. CA, California) that we’ll use later to ‘beautify’ our plots.</p>
<pre class="r"><code>states.abbrev &lt;- read_csv(&#39;https://worldpopulationreview.com/static/states/abbr-name-list.csv&#39;)

states.abbrev</code></pre>
<pre><code>## # A tibble: 51 x 2
##    name                 abbreviation
##    &lt;chr&gt;                &lt;chr&gt;       
##  1 Alabama              AL          
##  2 Alaska               AK          
##  3 Arizona              AZ          
##  4 Arkansas             AR          
##  5 California           CA          
##  6 Colorado             CO          
##  7 Connecticut          CT          
##  8 Delaware             DE          
##  9 District Of Columbia DC          
## 10 Florida              FL          
## # … with 41 more rows</code></pre>
<p>Lastly, from that same website I have downloaded the (projected) 2020 census estimates, which we’ll read in and use to standardize our data to e.g. tests per 100,000 residents.</p>
<pre class="r"><code>states.population &lt;- &#39;../data/covid-tidyverse/covid.us.state.population.csv&#39; %&gt;%
    read_csv() %&gt;%
    select(c(&#39;rank&#39;,&#39;State&#39;,&#39;Pop&#39;))

states.population</code></pre>
<pre><code>## # A tibble: 52 x 3
##     rank State               Pop
##    &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;
##  1     1 California     39937489
##  2     2 Texas          29472295
##  3     3 Florida        21992985
##  4     4 New York       19440469
##  5     5 Pennsylvania   12820878
##  6     6 Illinois       12659682
##  7     7 Ohio           11747694
##  8     8 Georgia        10736059
##  9     9 North Carolina 10611862
## 10    10 Michigan       10045029
## # … with 42 more rows</code></pre>
</div>
<div id="munge" class="section level3">
<h3>Munge</h3>
<p>To munge is to manipulate raw data. We’ll start by combining the three different datasets we have loaded to look at testing rates among the most populated states.</p>
<pre class="r"><code>testing.data &lt;- states.data %&gt;%
        # add the longform name of each state for later plots
    left_join(states.abbrev, by = c(&#39;state&#39; = &#39;abbreviation&#39;)) %&gt;%
        # also that we can add the population for calculations
    left_join(states.population, by = c(&#39;name&#39; = &#39;State&#39;))

testing.data %&gt;%
        # peeking at newly joined variables
    select(c(&#39;state&#39;,&#39;date&#39;,&#39;name&#39;,&#39;rank&#39;,&#39;Pop&#39;))</code></pre>
<pre><code>## # A tibble: 2,929 x 5
##    state date       name                  rank      Pop
##    &lt;chr&gt; &lt;date&gt;     &lt;chr&gt;                &lt;dbl&gt;    &lt;dbl&gt;
##  1 AK    2020-04-26 Alaska                  49   734002
##  2 AL    2020-04-26 Alabama                 24  4908621
##  3 AR    2020-04-26 Arkansas                33  3038999
##  4 AS    2020-04-26 &lt;NA&gt;                    NA       NA
##  5 AZ    2020-04-26 Arizona                 14  7378494
##  6 CA    2020-04-26 California               1 39937489
##  7 CO    2020-04-26 Colorado                21  5845526
##  8 CT    2020-04-26 Connecticut             29  3563077
##  9 DC    2020-04-26 District Of Columbia    NA       NA
## 10 DE    2020-04-26 Delaware                46   982895
## # … with 2,919 more rows</code></pre>
<p>Then we’ll use the lubridate package within the tidyverse to quickly split the date into month # and day # components so we can look at data from the 9th of March onward.</p>
<pre class="r"><code>testing.data %&lt;&gt;%
    mutate(month = lubridate::month(date)) %&gt;%
    mutate(day = lubridate::day(date)) %&gt;%
    # filter for data after 9 march
    filter(month &gt;= 3) %&gt;%
    filter(day &gt;= 9)

testing.data %&gt;%
    select(c(&#39;state&#39;,&#39;date&#39;,&#39;total_test_results&#39;,&#39;month&#39;,&#39;day&#39;))</code></pre>
<pre><code>## # A tibble: 2,258 x 5
##    state date       total_test_results month   day
##    &lt;chr&gt; &lt;date&gt;                  &lt;int&gt; &lt;dbl&gt; &lt;int&gt;
##  1 AK    2020-04-26              16177     4    26
##  2 AL    2020-04-26              73551     4    26
##  3 AR    2020-04-26              39469     4    26
##  4 AS    2020-04-26                  3     4    26
##  5 AZ    2020-04-26              64811     4    26
##  6 CA    2020-04-26             526084     4    26
##  7 CO    2020-04-26              59791     4    26
##  8 CT    2020-04-26              79811     4    26
##  9 DC    2020-04-26              18068     4    26
## 10 DE    2020-04-26              19249     4    26
## # … with 2,248 more rows</code></pre>
</div>
<div id="plot" class="section level3">
<h3>Plot</h3>
</div>

    </div>
</article>

<div class="markdown-body" id="license">
    <blockquote>
        <p>Unless otherwise noted, the content of this site is licensed under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License (CC BY-NC-SA 4.0)</a>.</p>
    </blockquote>
</div>




            </div>
            
            <div class="col-md-3 col-12 float-left" id="sidebar">
                
<div id="widget-toc">
    <h5>TOC</h5>
    
</div>

<div id="widget-pages">
    <h5>Pages</h5>
    <ul>
        
        
        <li>
            <a href="/">Home</a>
        </li>
        
        <li>
            <a href="/about/">About</a>
        </li>
        
    </ul>
</div>
<div id="widget-tags">
    <h5>Tags</h5>
    <div>
        
        <span>
            <a href="/tags/tidyverse/">tidyverse</a>
        </span>
        
    </div>
</div>
<div id="widget-links">
    <h5>Links</h5>
    <ul>
        
        <li>
            <a href="https://github.com/sxmorgan" target="_blank"><span>GitHub</span></a>
        </li>
        
    </ul>
</div>

            </div>
            
            
            <div id="scroll-top">
                <i class="fas fa-chevron-up"></i>
            </div>
            
        </div>
    </main>

    <footer>
    <div class="container-lg text-center">
        <p>&copy; 2020 <a href="/">Morgan Essex</a> | Powered by <a href="https://github.com/amzrk2/hugo-theme-fuji/" target="_blank">Fuji</a> & <a href="https://gohugo.io/" target="_blank">Hugo</a> </p>
    </div>
</footer>
    




<script>
    $("#widget-toc a").click(function () {
        $("html, body").animate({
            scrollTop: $($(this).attr("href")).offset().top
        });
        return false;
    });
</script>



<script>
    $("#scroll-top").click(function () {
        $("html, body").animate({
            scrollTop: 0
        });
    });
</script>


</body>

</html>