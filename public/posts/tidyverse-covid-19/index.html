<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>data&#43;science/posts/tidyverse-covid-19/</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <meta name="googlebot" content="index,follow,snippet,archive">
    <link rel="stylesheet" href='/hugo-theme-console/css/terminal-0.7.1.min.css'>
    <link rel="stylesheet" href='/hugo-theme-console/css/animate-3.7.2.min.css'>
    <link rel="stylesheet" href='/hugo-theme-console/css/console.css'>
    
      <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->
    <link rel="icon" 
      type="image/png" 
      href="/favicon-comp.png"><meta property="og:title" content="A Simple Tidyverse Workflow" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/tidyverse-covid-19/" /><meta property="article:published_time" content="2020-05-02T00:00:00+00:00" />



<meta name="twitter:title" content="A Simple Tidyverse Workflow"/>
<meta name="twitter:description" content="Exploratory data analysis with COVID-19 testing and prognosis in the US."/>

</head>
<body class="terminal">
    <div class="container">
        <div class="terminal-nav">
          <header class="terminal-logo">
            <div class="logo terminal-prompt">
              
              
              <a href="/" class="no-style site-name">data&#43;science</a>:~/ <a href='posts'></a> <a href='/'>posts</a>/<a href='tidyverse-covid'></a> <a href='//'>tidyverse-covid</a>/
            </header>
          <nav class="terminal-menu">
            <ul vocab="https://schema.org/" typeof="BreadcrumbList">
                
                <li><a href="/about/" typeof="ListItem">about/</a></li>
                
                <li><a href="/posts/" typeof="ListItem">posts/</a></li>
                
                <li><a href="/resources/" typeof="ListItem">resources/</a></li>
                
                <li><a href="/tags/" typeof="ListItem">tags/</a></li>
                
            </ul>
          </nav>
        </div>
    </div>

    <div class="container animated zoomIn fast">
        
<h1>A Simple Tidyverse Workflow</h1>

2 May 2020

<br/>

  <link rel="stylesheet" href="tomorrow.css" type="text/css" />

<div id="TOC">
<ul>
<li><a href="#import">Import</a></li>
<li><a href="#munge">Munge</a></li>
<li><a href="#visualize">Visualize</a></li>
<li><a href="#summarize">Summarize</a></li>
</ul>
</div>

<p>This post is intended to be a follow up from my presentation for members of the ECRC and a resource. If you haven’t seen those or are new here, check out my previous <a href="../why-tidyverse">post</a> on why you should use the tidyverse. This is the workflow we’ll be completing today:</p>
<div class="figure">
<img src="../why-tidyverse/data/data.science.process.png" />

</div>
<p>In follow up posts I will go through this same workflow with microbiome-specific examples, but for this introductory demo we are going to be using data from the <a href="https://covidtracking.com/">COVID Tracking Project</a> in the US. One of my favorite things about R is the active development community: we don’t need to download any files or even access this data through the API, because someone’s already created a <code>covid19us</code> wrapper package to do this for us with a single line of code in R.</p>
<div id="import" class="section level2">
<h2>Import</h2>
<p>Calling <code>library(tidyverse)</code> will load all the functions we’ll need, except we must also import <code>magrittr</code>, which provides us with the pipe (<code>%&gt;%</code>) operator and some ‘aliases’ useful when using chaining syntax. Additionally, I always load the <a href="https://cran.r-project.org/web/packages/ggsci/vignettes/ggsci.html">ggsci</a> and <a href="https://rpkgs.datanovia.com/ggpubr/index.html">ggpubr</a> packages for my plots.</p>
<pre class="r"><code>library(tidyverse)
library(magrittr) 
library(covid19us) 
library(ggsci) 
library(ggpubr)</code></pre>
<p>Then, let’s load the complete longitudinal dataset and select the variables that will be relevant for our analysis.</p>
<!-- ```{r load.data.1} -->
<!-- states.data <- get_states_daily() %>% -->
<!--     select(c('state','date','positive','negative','death','total_test_results')) -->
<!-- states.data -->
<!-- ``` -->
<!-- Additionally, we're going to pull a csv file from https://worldpopulationreview.com/ that contains state-abbreviation pairs (e.g. CA, California) that we'll use later to 'beautify' our plots. -->
<!-- ```{r load.data.2} -->
<!-- states.abbrev <- read_csv('https://worldpopulationreview.com/static/states/abbr-name-list.csv') -->
<!-- states.abbrev -->
<!-- ``` -->
<!-- Lastly, from that same website I have downloaded the (projected) 2020 census estimates, which we'll read in and use to standardize our data to tests per 100,000 residents. -->
<!-- ```{r load.data.3} -->
<!-- states.population <- 'data/covid.us.state.population.csv' %>% -->
<!--     read_csv() %>% -->
<!--     select(c('rank','State','Pop')) -->
<!-- states.population -->
<!-- ``` -->
</div>
<div id="munge" class="section level2">
<h2>Munge</h2>
<p>To munge is to manipulate raw data. We’ll start by combining the three different datasets we have loaded to look at testing rates among the most populated states.</p>
<!-- ```{r munge.1} -->
<!-- testing.data <- states.data %>% -->
<!--     left_join(states.abbrev, by = c('state' = 'abbreviation')) %>% -->
<!--     left_join(states.population, by = c('name' = 'State')) -->
<!-- # peeking at newly joined variables -->
<!-- testing.data %>% -->
<!--     select(c('state','date','name','rank','Pop')) -->
<!-- ``` -->
<!-- Then we'll use the lubridate package within the tidyverse to quickly split the dates into month and day components so we can look at data from the 9th of March. -->
<!-- ```{r munge.2} -->
<!-- testing.data %<>% -->
<!--     mutate(month = lubridate::month(date)) %>% -->
<!--     mutate(day = lubridate::day(date)) %>% -->
<!--     filter(month >= 3) %>% -->
<!--     filter(day >= 9) -->
<!-- testing.data %>% -->
<!--     select(c('state','date','total_test_results','month','day')) -->
<!-- ``` -->
</div>
<div id="visualize" class="section level2">
<h2>Visualize</h2>
</div>
<div id="summarize" class="section level2">
<h2>Summarize</h2>
<style type="text/css">
img {
    display: block;
    margin-left: auto;
    margin-right: auto;
    width: 70%;
    padding: 10px
}
</style>
</div>




        <div class="footer">
    Powered by <a href="https://gohugo.io/">Hugo</a> and <a href="https://www.netlify.com/">Netlify</a>. 
</div>
    </div>
  </body>
</html>
