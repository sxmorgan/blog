---
title: "Introduction to the Tidyverse"
author: "Morgan Essex"
subtitle: 'Example: COVID-19 Testing and Prognosis'
output:
  html_document:
    df_print: paged
---
<br><br>

We're going to be using data from the COVID Tracking Project in the US. To my knowledge, nothing similar exists for European or world data, or we would have looked at local data. The API is easily accessible, and a woman already created a wrapper package for R to make accessing historical and current statistics incredibly simple. That's what we'll use today.

![](/Users/messex/Desktop/teaching_tidyverse/covidtracking.png)

<br><br>
First, let's load the packages we'll use for this analysis. Calling `library(tidyverse)` will load all the functions we'll need today, except we must also import `magrittr`, which provides us with the pipe (`%>%`) operator for chaining syntax.

```{r options, echo = FALSE}
options(WordpressLogin = c(sxmorgan = '#dc8dsDC8DS'),
        WordPressURL = 'sxmorgan.wordpress.com')
```

```{r libraries}
library(tidyverse)  # data science toolkit
library(magrittr)   # corresponding operators
library(covid19us)  # scrapes https://covidtracking.com/ API
library(ggsci)      # custom color palettes
library(ggpubr)     # publication-ready plots
library(knitr)      # create docs of text + code
```

<br><br>
Then, let's load the complete longitudinal dataset and select the variables that will be relevant for our analysis. Additionally, we're going to pull a csv file from https://worldpopulationreview.com/ that contains state-abbreviation pairs (e.g. CA, California) that we'll use later to 'beautify' our plots. Lastly, from that same website I have downloaded the (projected) 2020 census estimates, which we'll read in and use to standardize our data to e.g. tests per 100,000 residents.

```{r load.data}
states.data <- get_states_daily() %>%
    select(c('state','date','positive','negative','death','total_test_results'))

states.data %>%
    dplyr::slice(1:10) %>%
    knitr::kable(results = 'html')

states.abbrev <- read_csv('https://worldpopulationreview.com/static/states/abbr-name-list.csv')

states.population <- '~/Desktop/teaching_tidyverse/us.state.population.csv' %>%
    read_csv() %>%
    select(c('rank','State','Pop'))
```