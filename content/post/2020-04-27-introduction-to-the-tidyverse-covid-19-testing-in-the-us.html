---
title: 'Introduction to the Tidyverse'
subtitle: 'COVID-19 Testing in the US'
author: Morgan Essex
date: '2020-04-27'
slug: tidyverse-covid-19
categories:
  - R
tags:
  - tidyverse
description: '...'
---



<p>We’re going to be using data from the COVID Tracking Project in the US. The API is easily accessible, and a woman already created a wrapper package for R to make accessing historical and current statistics incredibly simple.</p>
<div class="figure">
<img src="../data/covid-tidyverse/covidtracking.png" />

</div>
<p><br><br> First, let’s load the packages we’ll use for this analysis. Calling <code>library(tidyverse)</code> will load all the functions we’ll need today, except we must also import <code>magrittr</code>, which provides us with the pipe (<code>%&gt;%</code>) operator for chaining syntax.</p>
<pre class="r"><code>library(tidyverse)  # data science toolkit</code></pre>
<pre><code>## Warning: package &#39;tibble&#39; was built under R version 3.6.2</code></pre>
<pre><code>## Warning: package &#39;purrr&#39; was built under R version 3.6.2</code></pre>
<pre class="r"><code>library(magrittr)   # corresponding operators
library(covid19us)  # scrapes https://covidtracking.com/ API</code></pre>
<pre><code>## Warning: package &#39;covid19us&#39; was built under R version 3.6.2</code></pre>
<pre class="r"><code>library(ggsci)      # custom color palettes
library(ggpubr)     # publication-ready plots
library(knitr)      # create docs of text + code</code></pre>
<p><br><br> Then, let’s load the complete longitudinal dataset and select the variables that will be relevant for our analysis. Additionally, we’re going to pull a csv file from <a href="https://worldpopulationreview.com/" class="uri">https://worldpopulationreview.com/</a> that contains state-abbreviation pairs (e.g. CA, California) that we’ll use later to ‘beautify’ our plots. Lastly, from that same website I have downloaded the (projected) 2020 census estimates, which we’ll read in and use to standardize our data to e.g. tests per 100,000 residents.</p>
<pre class="r"><code>states.data &lt;- get_states_daily() %&gt;%
    select(c(&#39;state&#39;,&#39;date&#39;,&#39;positive&#39;,&#39;negative&#39;,&#39;death&#39;,&#39;total_test_results&#39;))

states.data</code></pre>
<pre><code>## # A tibble: 2,937 x 6
##    state date       positive negative death total_test_results
##    &lt;chr&gt; &lt;date&gt;        &lt;int&gt;    &lt;int&gt; &lt;int&gt;              &lt;int&gt;
##  1 AK    2020-04-26      341    15836     9              16177
##  2 AL    2020-04-26     6270    67281   216              73551
##  3 AR    2020-04-26     2941    36528    49              39469
##  4 AS    2020-04-26        0        3     0                  3
##  5 AZ    2020-04-26     6526    58285   275              64811
##  6 CA    2020-04-26    42164   483920  1710             526084
##  7 CO    2020-04-26    12968    46823   672              59791
##  8 CT    2020-04-26    25269    54542  1924              79811
##  9 DC    2020-04-26     3841    14227   178              18068
## 10 DE    2020-04-26     4034    15215   120              19249
## # … with 2,927 more rows</code></pre>
<pre class="r"><code>states.abbrev &lt;- read_csv(&#39;https://worldpopulationreview.com/static/states/abbr-name-list.csv&#39;)

states.population &lt;- &#39;../data/covid-tidyverse/covid.us.state.population.csv&#39; %&gt;%
    read_csv() %&gt;%
    select(c(&#39;rank&#39;,&#39;State&#39;,&#39;Pop&#39;))</code></pre>
